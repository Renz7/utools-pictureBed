(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b9e2f18"],{"1e4b":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"20px"}},[a("a-row",{attrs:{type:"flex",justify:"center"}},[a("div",{attrs:{id:"file-area"},on:{click:e.openFiles,dragenter:function(e){e.preventDefault()},drop:function(t){return t.preventDefault(),t.stopPropagation(),e.fileBoxDrag(t)},dragover:function(e){e.preventDefault()},dragleave:function(e){e.preventDefault()}}},[a("a-icon",{attrs:{type:"cloud-upload"}})],1)]),a("a-row",{staticStyle:{"margin-top":"30px"},attrs:{type:"flex",justify:"space-between"}},[a("a-col",{attrs:{span:16}},[a("a-row",[a("a-col",{attrs:{span:8}},[a("a-select",{staticStyle:{width:"100%"},on:{change:e.selectModeChange},model:{value:e.image.selectFileMode,callback:function(t){e.$set(e.image,"selectFileMode",t)},expression:"image.selectFileMode"}},e._l(e.fileModeKey,(function(t,o){return a("a-select-option",{key:o,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("a-col",{attrs:{span:8}},[a("div",{staticStyle:{display:"flex","align-items":"center","margin-left":"10px"}},[a("a-select",{staticStyle:{width:"100%"},model:{value:e.configure.autoCopy.mode,callback:function(t){e.$set(e.configure.autoCopy,"mode",t)},expression:"configure.autoCopy.mode"}},[a("a-select-option",{attrs:{value:"url"}},[e._v(" url ")]),a("a-select-option",{attrs:{value:"md"}},[e._v(" md ")]),a("a-select-option",{attrs:{value:"html"}},[e._v(" html ")])],1),a("a-tooltip",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" 自动复制开关 ")]},proxy:!0}])},[a("a-switch",{staticStyle:{"margin-left":"10px"},model:{value:e.configure.autoCopy.enabled,callback:function(t){e.$set(e.configure.autoCopy,"enabled",t)},expression:"configure.autoCopy.enabled"}})],1)],1)])],1)],1),a("a-col",{attrs:{span:5}},[a("a-row",{attrs:{type:"flex",justify:"start"}},[a("a-col",{attrs:{span:12}},[a("a-button",{on:{click:e.settingShow}},[e._v("设置")])],1),a("a-col",{attrs:{span:12}},[a("a-button",{on:{click:e.clearImage}},[e._v("清空")])],1)],1)],1)],1),a("a-row",{staticStyle:{"padding-top":"10px"},attrs:{type:"flex",justify:"start"}},e._l(e.image.data,(function(t,o){return a("a-col",{key:o,staticClass:"item",staticStyle:{padding:"15px"}},[a("a-spin",{attrs:{tip:"Loading...",spinning:t.loading}},[a("img",{staticStyle:{"border-radius":"10px"},attrs:{src:t.image,width:"200px"}}),t.loading?e._e():a("div",{staticClass:"options"},[a("span",{on:{click:function(a){return e.copy(t.image)}}},[e._v("URL")]),a("span",{on:{click:function(a){return e.htmlCopy(t.image)}}},[e._v("HTML")]),a("span",{on:{click:function(a){return e.mdCopy(t.image)}}},[e._v("MD")]),a("span",{on:{click:function(a){return e.deleteItem(t.id)}}},[e._v("删除")]),a("span",[e._v(e._s(t.createTime))])])])],1)})),1)],1)},n=[],i=(a("99af"),a("4160"),a("caad"),a("b0c0"),a("4d63"),a("ac1f"),a("25f0"),a("2532"),a("159b"),a("5530")),r=a("2f62"),s=(a("d3b7"),a("4360")),c=a("2b0e"),l=c["a"].prototype.$url.imgkr;function u(){}u.uploadImage=function(e,t){var a=new FormData;a.append("file",e);var o=window.nodeFetch?window.nodeFetch:window.fetch;o("".concat(l,"/api/v2/files/upload"),{headers:{Cookie:"_ga=GA1.2.1327215634.1593694091; _gid=GA1.2.668497135.1596770201","X-Requested-With":"XMLHttpRequest",Referer:"https://imgkr.com/","Content-Type":"multipart/form-data;","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36"},method:"post",body:a}).then((function(e){return e.json()})).then((function(e){console.log(e),200===e.code?s["a"].commit("setImage",{url:e.data,id:t}):c["a"].prototype.$message.warning("上传失败")})).catch((function(){c["a"].prototype.$message.warning("上传失败")}))};var d=u;function p(){}p.uploadImage=function(e,t){var a=new FormData;a.append("fileToUpload",e),a.append("reqtype","fileupload"),fetch("https://catbox.moe/user/api.php",{method:"POST",body:a}).then((function(e){return e.text()})).then((function(e){s["a"].commit("setImage",{url:e,id:t})})).catch((function(){c["a"].prototype.$message.warning("上传失败")}))};var g=p;function f(){}f.uploadImage=function(e,t,a){var o=new FormData;o.append("image",e),o.append("apiType",a),o.append("token",s["a"].state.oss.rruu.token),fetch("https://img.rruu.net/api/upload",{method:"POST",body:o}).then((function(e){return e.json()})).then((function(e){s["a"].commit("setImage",{url:e.data.url[a],id:t})})).catch((function(){c["a"].prototype.$message.warning("上传失败")}))};var m=f;function h(){}h.uploadImage=function(e,t){var a=new FormData;a.append("uploaded_file[]",e),fetch("https://upload.cc/image_upload",{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){0===e.total_error?s["a"].commit("setImage",{url:"https://upload.cc/".concat(e.success_image[0].url),id:t}):c["a"].prototype.$message.warning("上传失败")})).catch((function(){c["a"].prototype.$message.warning("上传失败")}))};var v=h;function y(){}y.uploadImage=function(e,t){var a=new FormData;a.append("file",e),fetch("https://imgurl.org/upload/ftp",{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){s["a"].commit("setImage",{url:e.url,id:t})})).catch((function(){c["a"].prototype.$message.warning("上传失败")}))};var w=y;function b(){}b.uploadImage=function(e,t,a){var o=new FormData;o.append("image",e),o.append("apiType",a),o.append("token",s["a"].state.oss.tudo.token),fetch("".concat(c["a"].prototype.$url.ac,"/api/upload"),{method:"POST",body:o}).then((function(e){return e.json()})).then((function(e){s["a"].commit("setImage",{url:e.data.url[a.toLowerCase()],id:t})})).catch((function(){c["a"].prototype.$message.warning("上传失败")}))};var k=b;function S(){}S.uploadImage=function(e,t){var a=new FormData;a.append("image_field",e),fetch("https://niupic.com/index/upload/process",{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){200===e.code?s["a"].commit("setImage",{url:"https://".concat(e.data),id:t}):c["a"].prototype.$message.warning("上传失败")})).catch((function(){c["a"].prototype.$message.warning("上传失败")}))};var I=S,x=function(e,t){var a=s["a"].state.image.selectFileMode;switch(a){case"图壳":d.uploadImage(e,t);break;case"猫盒":g.uploadImage(e,t);break;case"如优-阿里图床":m.uploadImage(e,t,"ali");break;case"如优-头条":m.uploadImage(e,t,"toutiao");break;case"如优-网易":m.uploadImage(e,t,"neteasy");break;case"如优-掘金":m.uploadImage(e,t,"juejin");break;case"如优-搜狗":m.uploadImage(e,t,"sougou");break;case"如优-Postimages":m.uploadImage(e,t,"postimages");break;case"土豆-小米":k.uploadImage(e,t,"xiaomi");break;case"土豆-头条":k.uploadImage(e,t,"toutiao");break;case"土豆-百度":k.uploadImage(e,t,"BaiDu");break;case"uploadCC":v.uploadImage(e,t);break;case"imgUrlOrg":w.uploadImage(e,t);break;case"牛图网":I.uploadImage(e,t);break}if("阿里云OSS"===a){var o=c["a"].prototype.$aliOss;if(console.log("11111111111111"),!o.client){var n=o.getClient();n||c["a"].prototype.$message.warning("请重新配置 ali-oss")}o.uploadFile(e,t)}else if("腾讯云OSS"===a){var i=c["a"].prototype.$tencentOss;if(!i.client){var r=i.getClient();r||c["a"].prototype.$message.warning("请重新配置 tencent-oss")}i.uploadFile(e,t)}},$=a("077b"),O=(a("d81d"),"xiaou-bookmark-"),_=["oss","image","configure"];function F(){}function C(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=utools.db.get("".concat(O).concat(e));return console.log(a),!!a&&(t?a.data:a)}function T(e,t){var a,o=C(e,!1);a=utools.db.put({_id:"".concat(O).concat(e),data:t,_rev:o._rev}),console.log("update"+a.toString())}F.save=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];t.map((function(e){var t=s["a"].state[e];T(e,t)}))},F.readAll=function(){console.log("load...."),F.read.apply(F,_)},F.read=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];t.map((function(e){var t=C(e);console.log(e),console.log(t),t&&(s["a"].state[e]=t)}))},window.saveALL=function(){console.log("保存"),F.save.apply(F,_)},F.playPromptTone=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=new Audio;if(a.loop=!1,t){a.play();var o=!0;a.addEventListener("ended",(function(){o&&(a.src="https://xiaou520.gitee.io/sound/".concat(e),a.play(),o=!1)}),!1)}else a.src="https://xiaou520.gitee.io/sound/".concat(e),a.play()},F.isNewVersion=function(){var e=window.pluginInfo;if(console.log(e),C("version")!==e.version){if(F.playPromptTone("update.wav"),window.pluginInfo.update){console.log("更新数据");var t=C("oss"),a=t,o=s["a"].state.oss;s["a"].state.oss=Object(i["a"])(Object(i["a"])({},o),a),F.save("oss")}return T("version",e.version),window.createUpdateWindow(),!0}return console.log("false"),!1};var D=F,j={data:function(){return{fileModeKey:["阿里云OSS","腾讯云OSS","土豆-小米","土豆-头条","土豆-百度","图壳","猫盒","uploadCC","imgUrlOrg","牛图网","如优-Postimages","如优-阿里图床","如优-头条","如优-网易","如优-掘金","如优-搜狗"]}},computed:Object(i["a"])({},Object(r["b"])(["image","configure"])),created:function(){var e=this;utools.onPluginReady((function(){D.isNewVersion(),D.readAll()})),utools.onPluginOut((function(){window.saveALL()})),utools.onPluginEnter((function(t){var a=t.code,o=t.type,n=t.payload;t.optional;if(console.log("用户进入插件",a,o,n),e.$store.commit("clearInvalidImage"),console.log(n),"files"===o)console.log(n),n.forEach((function(t){e.uploadFilePath(t.path)}));else if("img"===o){/data:image\/(.*?);/.test(n);var i=Date.now();e.image.data.unshift({id:i,image:"",loading:!0});var r=window.dataURLtoFile(n,"".concat(Date.now(),".").concat(RegExp.$1));x(r,i)}}))},methods:{settingShow:function(){this.$router.push({name:"aliOss"})},selectModeChange:function(e){console.log(e),"阿里云OSS"===e?this.$store.state.oss.aliOss.accessKeySecret||(this.$message.warning("使用阿里云OSS在设置中需要配置"),this.image.selectFileMode="图壳"):"腾讯云OSS"===e?this.$store.state.oss.tencentOss.secretKey||(this.$message.warning("使用腾讯云OSS在设置中需要配置"),this.image.selectFileMode="图壳"):e.includes("土豆")?this.$store.state.oss.tudo.token||(this.$message.warning("使用土豆需要在设置中需要配置token"),this.image.selectFileMode="图壳"):e.includes("如优")&&(this.$store.state.oss.rruu.token||(this.$message.warning("使用如优需要在设置中需要配置token"),this.image.selectFileMode="图壳"))},uploadFilePath:function(e){var t=window.readFile(e),a=Date.now();this.image.data.unshift({id:a,image:"",loading:!0}),x(t,a)},openFiles:function(){var e=this,t=window.selectFile();t instanceof Array?t.forEach((function(t){e.uploadFilePath(t)})):this.uploadFilePath(t)},clearImage:function(){this.$store.commit("clearImage")},deleteItem:function(e){console.log(Object($["a"])("YYYY-mm-dd",new Date)),this.$store.commit("deleteImageItem",e)},copy:function(e){var t=this;console.log(e),console.log(this),this.$copyText(e).then((function(){t.$message.success("复制成功")}))},htmlCopy:function(e){var t='<img src="'.concat(e,'"  />');this.copy(t)},mdCopy:function(e){var t="![](".concat(e,")");this.copy(t)},fileBoxDrag:function(e){var t=this,a=[];[].forEach.call(e.dataTransfer.files,(function(e){a.push(e)}),!1),console.log(a),a.forEach((function(e){var a=["image/png","image/jpeg","image/gif"];if(a.includes(e.type)){console.log(e);var o=Date.now();t.image.data.unshift({id:o,image:"",loading:!0}),console.log(e.name),x(e,o)}else t.$message.warning("不支持该格式")}))}}},M=j,P=(a("c793"),a("2877")),A=Object(P["a"])(M,o,n,!1,null,"927c55ec",null);t["default"]=A.exports},2532:function(e,t,a){"use strict";var o=a("23e7"),n=a("5a34"),i=a("1d80"),r=a("ab13");o({target:"String",proto:!0,forced:!r("includes")},{includes:function(e){return!!~String(i(this)).indexOf(n(e),arguments.length>1?arguments[1]:void 0)}})},"5a34":function(e,t,a){var o=a("44e7");e.exports=function(e){if(o(e))throw TypeError("The method doesn't accept regular expressions");return e}},"99af":function(e,t,a){"use strict";var o=a("23e7"),n=a("d039"),i=a("e8b5"),r=a("861d"),s=a("7b0b"),c=a("50c4"),l=a("8418"),u=a("65f0"),d=a("1dde"),p=a("b622"),g=a("2d00"),f=p("isConcatSpreadable"),m=9007199254740991,h="Maximum allowed index exceeded",v=g>=51||!n((function(){var e=[];return e[f]=!1,e.concat()[0]!==e})),y=d("concat"),w=function(e){if(!r(e))return!1;var t=e[f];return void 0!==t?!!t:i(e)},b=!v||!y;o({target:"Array",proto:!0,forced:b},{concat:function(e){var t,a,o,n,i,r=s(this),d=u(r,0),p=0;for(t=-1,o=arguments.length;t<o;t++)if(i=-1===t?r:arguments[t],w(i)){if(n=c(i.length),p+n>m)throw TypeError(h);for(a=0;a<n;a++,p++)a in i&&l(d,p,i[a])}else{if(p>=m)throw TypeError(h);l(d,p++,i)}return d.length=p,d}})},ab13:function(e,t,a){var o=a("b622"),n=o("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(a){try{return t[n]=!1,"/./"[e](t)}catch(o){}}return!1}},c793:function(e,t,a){"use strict";var o=a("eafb"),n=a.n(o);n.a},caad:function(e,t,a){"use strict";var o=a("23e7"),n=a("4d64").includes,i=a("44d2"),r=a("ae40"),s=r("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:!s},{includes:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),i("includes")},d81d:function(e,t,a){"use strict";var o=a("23e7"),n=a("b727").map,i=a("1dde"),r=a("ae40"),s=i("map"),c=r("map");o({target:"Array",proto:!0,forced:!s||!c},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},eafb:function(e,t,a){}}]);