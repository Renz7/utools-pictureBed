(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f53c132"],{"1e4b":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{padding:"20px"}},[n("a-row",{attrs:{type:"flex",justify:"center"}},[n("div",{attrs:{id:"file-area"},on:{click:e.openFiles,dragenter:function(e){e.preventDefault()},drop:function(t){return t.preventDefault(),t.stopPropagation(),e.fileBoxDrag(t)},dragover:function(e){e.preventDefault()},dragleave:function(e){e.preventDefault()}}},[n("a-icon",{attrs:{type:"cloud-upload"}})],1)]),n("a-row",{staticStyle:{"margin-top":"30px"},attrs:{type:"flex",justify:"space-between"}},[n("a-col",{attrs:{span:16}},[n("a-row",[n("a-col",{attrs:{span:8}},[n("a-select",{staticStyle:{width:"100%"},on:{change:e.selectModeChange},model:{value:e.image.selectFileMode,callback:function(t){e.$set(e.image,"selectFileMode",t)},expression:"image.selectFileMode"}},e._l(e.fileModeKey,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),n("a-col",{attrs:{span:8}},[n("div",{staticStyle:{display:"flex","align-items":"center","margin-left":"10px"}},[n("a-select",{staticStyle:{width:"100%"},model:{value:e.configure.autoCopy.mode,callback:function(t){e.$set(e.configure.autoCopy,"mode",t)},expression:"configure.autoCopy.mode"}},[n("a-select-option",{attrs:{value:"url"}},[e._v(" url ")]),n("a-select-option",{attrs:{value:"md"}},[e._v(" md ")]),n("a-select-option",{attrs:{value:"html"}},[e._v(" html ")])],1),n("a-tooltip",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" 自动复制开关 ")]},proxy:!0}])},[n("a-switch",{staticStyle:{"margin-left":"10px"},model:{value:e.configure.autoCopy.enabled,callback:function(t){e.$set(e.configure.autoCopy,"enabled",t)},expression:"configure.autoCopy.enabled"}})],1)],1)])],1)],1),n("a-col",{attrs:{span:5}},[n("a-row",{attrs:{type:"flex",justify:"start"}},[n("a-col",{attrs:{span:12}},[n("a-button",{on:{click:e.settingShow}},[e._v("设置")])],1),n("a-col",{attrs:{span:12}},[n("a-button",{on:{click:e.clearImage}},[e._v("清空")])],1)],1)],1)],1),n("a-row",{staticStyle:{"padding-top":"10px"},attrs:{type:"flex",justify:"start"}},e._l(e.image.data,(function(t,a){return n("a-col",{key:a,staticClass:"item",staticStyle:{padding:"15px"}},[n("a-spin",{attrs:{tip:"Loading...",spinning:t.loading}},[n("img",{staticStyle:{"border-radius":"10px"},attrs:{src:t.image,width:"200px"}}),t.loading?e._e():n("div",{staticClass:"options"},[n("span",{on:{click:function(n){return e.copy(t.image)}}},[e._v("URL")]),n("span",{on:{click:function(n){return e.htmlCopy(t.image)}}},[e._v("HTML")]),n("span",{on:{click:function(n){return e.mdCopy(t.image)}}},[e._v("MD")]),n("span",{on:{click:function(n){return e.deleteItem(t.id)}}},[e._v("删除")]),n("span",[e._v(e._s(t.createTime))])])])],1)})),1)],1)},r=[],o=(n("99af"),n("4160"),n("caad"),n("4d63"),n("ac1f"),n("25f0"),n("2532"),n("159b"),n("96cf"),n("1da1")),s=n("5530"),i=n("2f62"),u=n("2b0e");n("d3b7");function c(){}c.uploadImage=function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("fileToUpload",t),a.append("reqtype","fileupload"),e.next=5,fetch("https://catbox.moe/user/api.php",{method:"POST",body:a}).then((function(e){return e.text()})).then((function(e){return{status:200,url:e,id:n}})).catch((function(){return{status:403,message:"上传失败"}}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();var l=c,p=n("4360");function d(){}d.uploadImage=function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,n,a){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=new FormData,r.append("image",t),r.append("apiType",a),r.append("token",p["a"].state.oss.rruu.token),e.next=6,fetch("https://img.rruu.net/api/upload",{method:"POST",body:r}).then((function(e){return e.json()})).then((function(e){return{status:200,url:e.data.url[a],id:n}})).catch((function(){return{status:403,message:"上传失败"}}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();var f=d;function g(){}g.uploadImage=function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("uploaded_file[]",t),e.next=4,fetch("https://upload.cc/image_upload",{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){return 0===e.total_error?{status:200,url:"https://upload.cc/".concat(e.success_image[0].url),id:n}:{status:403,message:"上传失败"}})).catch((function(){return{status:403,message:"上传失败"}}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();var m=g;function h(){}h.uploadImage=function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("file",t),e.next=4,fetch("https://imgurl.org/upload/ftp",{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){return{status:200,url:e.url,id:n}})).catch((function(){return{status:403,message:"上传失败"}}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();var v=h,y=function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,n){var a,r,o,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=p["a"].state.image.selectFileMode,e.t0=a,e.next="猫盒"===e.t0?4:"如优-阿里图床"===e.t0?7:"如优-头条"===e.t0?10:"如优-网易"===e.t0?13:"如优-掘金"===e.t0?16:"如优-搜狗"===e.t0?19:"如优-Postimages"===e.t0?22:"uploadCC"===e.t0?25:"imgUrlOrg"===e.t0?28:31;break;case 4:return e.next=6,l.uploadImage(t,n);case 6:return e.abrupt("return",e.sent);case 7:return e.next=9,f.uploadImage(t,n,"ali");case 9:return e.abrupt("return",e.sent);case 10:return e.next=12,f.uploadImage(t,n,"toutiao");case 12:return e.abrupt("return",e.sent);case 13:return e.next=15,f.uploadImage(t,n,"neteasy");case 15:return e.abrupt("return",e.sent);case 16:return e.next=18,f.uploadImage(t,n,"juejin");case 18:return e.abrupt("return",e.sent);case 19:return e.next=21,f.uploadImage(t,n,"sougou");case 21:return e.abrupt("return",e.sent);case 22:return e.next=24,f.uploadImage(t,n,"postimages");case 24:return e.abrupt("return",e.sent);case 25:return e.next=27,m.uploadImage(t,n);case 27:return e.abrupt("return",e.sent);case 28:return e.next=30,v.uploadImage(t,n);case 30:return e.abrupt("return",e.sent);case 31:if("阿里云OSS"!==a){e.next=43;break}if(r=u["a"].prototype.$aliOss,console.log("11111111111111"),r.client){e.next=38;break}if(o=r.getClient(),o){e.next=38;break}return e.abrupt("return",{status:403,message:"请重新配置 ali-oss"});case 38:return e.next=40,r.uploadFile(t,n);case 40:return e.abrupt("return",e.sent);case 43:if("腾讯云OSS"!==a){e.next=52;break}if(s=u["a"].prototype.$tencentOss,s.client){e.next=49;break}if(i=s.getClient(),i){e.next=49;break}return e.abrupt("return",{status:403,message:"请重新配置 tencent-oss"});case 49:return e.next=51,s.uploadFile(t,n);case 51:return e.abrupt("return",e.sent);case 52:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),w=n("077b"),b=(n("d81d"),"xiaou-bookmark-"),x=["oss","image","configure"];function S(){}function k(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=utools.db.get("".concat(b).concat(e));return console.log(n),!!n&&(t?n.data:n)}function O(e,t){var n,a=k(e,!1);n=utools.db.put({_id:"".concat(b).concat(e),data:t,_rev:a._rev}),console.log("update"+n.toString())}S.save=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.map((function(e){var t=p["a"].state[e];O(e,t)}))},S.readAll=function(){console.log("load...."),S.read.apply(S,x)},S.read=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.map((function(e){var t=k(e);console.log(e),console.log(t),t&&(p["a"].state[e]=t)}))},window.saveALL=function(){console.log("保存"),S.save.apply(S,x)},S.playPromptTone=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Audio;if(n.loop=!1,t){n.play();var a=!0;n.addEventListener("ended",(function(){a&&(n.src="https://xiaou520.gitee.io/sound/".concat(e),n.play(),a=!1)}),!1)}else n.src="https://xiaou520.gitee.io/sound/".concat(e),n.play()},S.isNewVersion=function(){var e=window.pluginInfo;if(console.log(e),k("version")!==e.version){if(S.playPromptTone("update.wav"),window.pluginInfo.update){console.log("更新数据");var t=k("oss"),n=t,a=p["a"].state.oss;a.aliOss=n.aliOss,a.tencentOss=n.tencentOss,a.rruu=n.rruu,S.save("oss")}return O("version",e.version),window.createUpdateWindow(),!0}return console.log("false"),!1};var C=S,I="猫盒",_={data:function(){return{fileModeKey:["阿里云OSS","腾讯云OSS","猫盒","uploadCC","imgUrlOrg","如优-Postimages","如优-阿里图床","如优-头条","如优-网易","如优-掘金","如优-搜狗"]}},computed:Object(s["a"])({},Object(i["b"])(["image","configure"])),created:function(){var e=this;utools.onPluginReady((function(){C.isNewVersion(),C.readAll()})),utools.onPluginOut((function(){window.saveALL()})),utools.onPluginEnter((function(t){var n=t.code,a=t.type,r=t.payload;t.optional;if(console.log("用户进入插件",n,a,r),e.$store.commit("clearInvalidImage"),console.log(r),"files"===a)console.log(r),r.forEach((function(t){e.uploadFilePath(t.path)}));else if("img"===a){/data:image\/(.*?);/.test(r);var o=window.dataURLtoFile(r,"".concat(Date.now(),".").concat(RegExp.$1));e.uploadImageHandler(o)}}))},methods:{uploadImageHandler:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var a,r,o,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.fileModeKey.includes(t.image.selectFileMode)){n.next=3;break}return t.$message.warning("该源已经下线,请选择其他源"),n.abrupt("return");case 3:return a=Date.now(),t.image.data.unshift({id:a,image:"",loading:!0}),n.next=7,y(e,a);case 7:r=n.sent,200===r.status?(o=r.url,s=r.id,t.$store.commit("setImage",{url:o,id:s}),t.$message.success("上传成功"),t.autoCopy(o)):t.$message.warning(r.message);case 9:case"end":return n.stop()}}),n)})))()},autoCopy:function(e){if(this.configure.autoCopy.enabled)switch(this.configure.autoCopy.mode){case"url":this.copy(e);break;case"md":this.mdCopy(e);break;case"html":this.htmlCopy(e);break}},settingShow:function(){this.$router.push({name:"aliOss"})},selectModeChange:function(e){console.log(e),"阿里云OSS"===e?this.$store.state.oss.aliOss.accessKeySecret||(this.$message.warning("使用阿里云OSS在设置中需要配置"),this.image.selectFileMode=I):"腾讯云OSS"===e?this.$store.state.oss.tencentOss.secretKey||(this.$message.warning("使用腾讯云OSS在设置中需要配置"),this.image.selectFileMode=I):e.includes("如优")&&(this.$store.state.oss.rruu.token||(this.$message.warning("使用如优需要在设置中需要配置token"),this.image.selectFileMode=I))},uploadFilePath:function(e){var t=window.readFile(e);this.uploadImageHandler(t)},openFiles:function(){var e=this,t=window.selectFile();t instanceof Array?t.forEach((function(t){e.uploadFilePath(t)})):this.uploadFilePath(t)},clearImage:function(){this.$store.commit("clearImage")},deleteItem:function(e){console.log(Object(w["a"])("YYYY-mm-dd",new Date)),this.$store.commit("deleteImageItem",e)},copy:function(e){var t=this;console.log(e),console.log(this),this.$copyText(e).then((function(){t.$message.success("复制成功")}))},htmlCopy:function(e){var t='<img src="'.concat(e,'"  />');this.copy(t)},mdCopy:function(e){var t="![](".concat(e,")");this.copy(t)},fileBoxDrag:function(e){var t=this,n=[];[].forEach.call(e.dataTransfer.files,(function(e){n.push(e)}),!1),console.log(n),n.forEach((function(e){var n=["image/png","image/jpeg","image/gif"];n.includes(e.type)?(console.log(e),t.uploadImageHandler(e)):t.$message.warning("不支持该格式")}))}}},$=_,F=(n("d670"),n("2877")),j=Object(F["a"])($,a,r,!1,null,"028e0a4a",null);t["default"]=j.exports},2532:function(e,t,n){"use strict";var a=n("23e7"),r=n("5a34"),o=n("1d80"),s=n("ab13");a({target:"String",proto:!0,forced:!s("includes")},{includes:function(e){return!!~String(o(this)).indexOf(r(e),arguments.length>1?arguments[1]:void 0)}})},"5a34":function(e,t,n){var a=n("44e7");e.exports=function(e){if(a(e))throw TypeError("The method doesn't accept regular expressions");return e}},"5dfe":function(e,t,n){},"99af":function(e,t,n){"use strict";var a=n("23e7"),r=n("d039"),o=n("e8b5"),s=n("861d"),i=n("7b0b"),u=n("50c4"),c=n("8418"),l=n("65f0"),p=n("1dde"),d=n("b622"),f=n("2d00"),g=d("isConcatSpreadable"),m=9007199254740991,h="Maximum allowed index exceeded",v=f>=51||!r((function(){var e=[];return e[g]=!1,e.concat()[0]!==e})),y=p("concat"),w=function(e){if(!s(e))return!1;var t=e[g];return void 0!==t?!!t:o(e)},b=!v||!y;a({target:"Array",proto:!0,forced:b},{concat:function(e){var t,n,a,r,o,s=i(this),p=l(s,0),d=0;for(t=-1,a=arguments.length;t<a;t++)if(o=-1===t?s:arguments[t],w(o)){if(r=u(o.length),d+r>m)throw TypeError(h);for(n=0;n<r;n++,d++)n in o&&c(p,d,o[n])}else{if(d>=m)throw TypeError(h);c(p,d++,o)}return p.length=d,p}})},ab13:function(e,t,n){var a=n("b622"),r=a("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(a){}}return!1}},caad:function(e,t,n){"use strict";var a=n("23e7"),r=n("4d64").includes,o=n("44d2"),s=n("ae40"),i=s("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:!i},{includes:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},d670:function(e,t,n){"use strict";var a=n("5dfe"),r=n.n(a);r.a},d81d:function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").map,o=n("1dde"),s=n("ae40"),i=o("map"),u=s("map");a({target:"Array",proto:!0,forced:!i||!u},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);